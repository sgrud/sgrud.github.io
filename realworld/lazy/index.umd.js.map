{"version":3,"file":"index.umd.js","sources":["../../packages/lazy/src/component/editor.tsx","../../packages/lazy/src/component/settings.tsx"],"sourcesContent":["import { Factor } from '@sgrud/core';\nimport { Component, Reference, Resolve, Route, Router } from '@sgrud/shell';\nimport { of } from 'rxjs';\nimport { Article, Endpoint, Errors } from 'sgrud-realworld-core';\nimport { AppComponent, ErrorMessages } from 'sgrud-realworld-eager';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'editor-component': EditorComponent;\n  }\n}\n\n@Route({\n  parent: AppComponent,\n  path: 'editor/:slug?'\n})\n@Component('editor-component')\nexport class EditorComponent extends HTMLElement implements Component {\n\n  public readonly styles: string[] = ['@import url(\"/realworld/style.css\");'];\n\n  @Factor(() => Router)\n  private readonly router!: Router;\n\n  @Reference('form', ['input'])\n  private readonly form?: HTMLFormElement | undefined;\n\n  @Resolve<'editor/:slug?'>(({ params }) => {\n    return params.slug\n      ? Endpoint.readArticle(params.slug)\n      : of(undefined);\n  })\n  private readonly article?: Article | undefined;\n\n  private errors?: Errors | undefined;\n\n  public get template(): JSX.Element {\n    return <>\n      <div className=\"editor-page\">\n        <div className=\"container page\">\n          <div className=\"row\">\n            <div className=\"col-md-10 col-xs-12 offset-md-1\">\n              <ErrorMessages errors={this.errors}/>\n              <form key=\"form\">\n                <fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"title\"\n                      placeholder=\"Article Title\"\n                      required={true}\n                      type=\"text\"\n                      value={this.article?.title ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"description\"\n                      placeholder=\"What's this article about?\"\n                      required={true}\n                      type=\"text\"\n                      value={this.article?.description ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <textarea\n                      className=\"form-control\"\n                      name=\"body\"\n                      placeholder=\"Write your article (in markdown)\"\n                      required={true}\n                      rows={8}>\n                      {this.article?.body}\n                    </textarea>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"tagList\"\n                      placeholder=\"Enter tags\"\n                      type=\"text\"\n                      value={this.article?.tagList.join(' ') ?? ''}/>\n                    <div className=\"tag-list\"></div>\n                  </fieldset>\n                  <button\n                    className=\"btn btn-lg btn-primary pull-xs-right\"\n                    disabled={!this.form?.checkValidity() || undefined!}\n                    onclick={() => this.updateArticle()}\n                    type=\"button\">\n                    Publish Article\n                  </button>\n                </fieldset>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>;\n  }\n\n  private updateArticle(this: this & Component): void {\n    const formData = new FormData(this.form);\n\n    if (this.errors) {\n      this.errors = undefined;\n      this.renderComponent!();\n    }\n\n    Endpoint.updateArticle({\n      ...this.article,\n      body: formData.get('body')!.toString(),\n      description: formData.get('description')!.toString(),\n      tagList: formData.get('tagList')!.toString().split(' '),\n      title: formData.get('title')!.toString()\n    }).subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: (article) => this.router.navigate(\n        `/article/${article.slug}`\n      ).subscribe()\n    });\n  }\n\n}\n","import { Factor } from '@sgrud/core';\nimport { Component, Fluctuate, Reference, Route, Router } from '@sgrud/shell';\nimport { Store } from '@sgrud/state';\nimport { Errors, UserStore } from 'sgrud-realworld-core';\nimport { AppComponent, ErrorMessages } from 'sgrud-realworld-eager';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'settings-component': SettingsComponent;\n  }\n}\n\n@Route({\n  parent: AppComponent,\n  path: 'settings'\n})\n@Component('settings-component')\nexport class SettingsComponent extends HTMLElement implements Component {\n\n  public readonly styles: string[] = ['@import url(\"/realworld/style.css\");'];\n\n  @Factor(() => Router)\n  private readonly router!: Router;\n\n  @Factor(() => UserStore)\n  private readonly userStore!: Store<UserStore>;\n\n  @Fluctuate(() => new UserStore())\n  private readonly userState?: Store.State<UserStore> | undefined;\n\n  @Reference('form', ['input'])\n  private readonly form?: HTMLFormElement | undefined;\n\n  private errors?: Errors | undefined;\n\n  public get template(): JSX.Element {\n    return <>\n      <div className=\"settings-page\">\n        <div className=\"container page\">\n          <div className=\"row\">\n            <div className=\"col-md-6 col-xs-12 offset-md-3\">\n              <h1 className=\"text-xs-center\">Your Settings</h1>\n              <ErrorMessages errors={this.errors}/>\n              <form key=\"form\">\n                <fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"image\"\n                      placeholder=\"URL of profile picture\"\n                      type=\"url\"\n                      value={this.userState?.image ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"username\"\n                      placeholder=\"Your Name\"\n                      required={true}\n                      type=\"text\"\n                      value={this.userState?.username ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <textarea\n                      className=\"form-control form-control-lg\"\n                      name=\"bio\"\n                      placeholder=\"Short bio about you\"\n                      rows={8}>\n                      {this.userState?.bio}\n                    </textarea>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"email\"\n                      pattern=\"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$\"\n                      placeholder=\"Email\"\n                      required={true}\n                      type=\"email\"\n                      value={this.userState?.email ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"password\"\n                      pattern=\"^.{8,}$\"\n                      placeholder=\"Password\"\n                      type=\"password\"/>\n                  </fieldset>\n                  <button\n                    className=\"btn btn-lg btn-primary pull-xs-right\"\n                    disabled={!this.form?.checkValidity() || undefined!}\n                    onclick={() => this.dispatchUpdate()}\n                    type=\"button\">\n                    Update Settings\n                  </button>\n                </fieldset>\n              </form>\n              <hr />\n              <button\n                className=\"btn btn-outline-danger\"\n                onclick={() => this.dispatchLogout()}\n                type=\"button\">\n                Or click here to logout.\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>;\n  }\n\n  private dispatchLogout(this: this & Component): void {\n    this.userStore.dispatch('logout').subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: () => this.router.navigate(\n        '/login'\n      ).subscribe()\n    });\n  }\n\n  private dispatchUpdate(this: this & Component): void {\n    const formData = new FormData(this.form);\n\n    if (this.errors) {\n      this.errors = undefined;\n      this.renderComponent!();\n    }\n\n    this.userStore.dispatch('update', [{\n      bio: formData.get('bio')!.toString(),\n      email: formData.get('email')!.toString(),\n      image: formData.get('image')!.toString(),\n      password: formData.get('password')!.toString(),\n      username: formData.get('username')!.toString()\n    }]).subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: ({ username }) => this.router.navigate(\n        `/profile/${username!}`\n      ).subscribe()\n    });\n  }\n\n}\n"],"names":["exports","EditorComponent","_HTMLElement","_this","_len","arguments","length","args","Array","_key","call","apply","concat","this","styles","router","form","article","errors","_inheritsLoose","prototype","updateArticle","_this2","formData","FormData","undefined","renderComponent","Endpoint","_extends","body","get","toString","description","tagList","split","title","subscribe","error","_ref","next","navigate","slug","_createClass","key","_this$article$title","_this$article","_this$article$descrip","_this$article2","_this$article3","_this$article$tagList","_this$article4","_this$form","_this3","_jsx","jsx","_Fragment","Fragment","children","className","_jsxs","ErrorMessages","jsxs","name","placeholder","required","type","value","rows","join","disabled","checkValidity","onclick","_wrapNativeSuper","HTMLElement","__decorate","Factor","Router","Reference","Resolve","_ref2","params","readArticle","of","Route","parent","AppComponent","path","Component","SettingsComponent","userStore","userState","_proto","dispatchLogout","dispatch","dispatchUpdate","bio","email","image","password","username","_ref3","_this$userState$image","_this$userState","_this$userState$usern","_this$userState2","_this$userState3","_this$userState$email","_this$userState4","_this4","pattern","UserStore","Fluctuate"],"mappings":"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"}