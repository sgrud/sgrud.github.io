import{__decorate as e}from"tslib";import{Target as r,HttpClient as t,Factor as s}from"@sgrud/core";import{map as o}from"rxjs";import{Endpoint as i,Credentials as l}from"sgrud-realworld-core";import{jsx as n,Fragment as a,jsxs as m}from"@sgrud/shell/jsx-runtime";import{Reference as d,Router as c,Route as p,Component as u}from"@sgrud/shell";import{AppComponent as h}from"sgrud-realworld-eager";let g=class extends i{user(e){return t.put(`${this.url}/user`,{user:e}).pipe(o(({response:e})=>(this.credentials.user=e.user,e.user)))}};g=e([r()],g);let f=class extends HTMLElement{constructor(...e){super(...e),this.styles=['@import url("//demo.productionready.io/main.css");'],this.credentials=void 0,this.endpoint=void 0,this.form=void 0,this.router=void 0,this.errors=[]}get template(){var e;return n(a,{children:n("div",{className:"settings-page",children:n("div",{className:"container page",children:n("div",{className:"row",children:m("div",{className:"col-md-6 col-xs-12 offset-md-3",children:[n("h1",{className:"text-xs-center",children:"Your Settings"}),this.errors.length>0&&n(a,{children:n("ul",{className:"error-messages",children:this.errors.map(e=>n(a,{children:n("li",{children:e})}))})}),n("form",{children:m("fieldset",{children:[n("fieldset",{className:"form-group",children:n("input",{className:"form-control",name:"image",placeholder:"URL of profile picture",type:"url",value:this.user.image})}),n("fieldset",{className:"form-group",children:n("input",{className:"form-control form-control-lg",name:"username",placeholder:"Your Name",required:!0,type:"text",value:this.user.username})}),n("fieldset",{className:"form-group",children:n("textarea",{className:"form-control form-control-lg",name:"bio",placeholder:"Short bio about you",rows:8,children:this.user.bio})}),n("fieldset",{className:"form-group",children:n("input",{className:"form-control form-control-lg",name:"email",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",placeholder:"Email",required:!0,type:"email",value:this.user.email})}),n("fieldset",{className:"form-group",children:n("input",{className:"form-control form-control-lg",name:"password",pattern:"^.{8,}$",placeholder:"Password",type:"password"})}),n("button",{className:"btn btn-lg btn-primary pull-xs-right",disabled:!(null!=(e=this.form)&&e.checkValidity())||void 0,onclick:()=>this.update(),type:"button",children:"Update Settings"})]})},"form")]})})})})})}get user(){return this.credentials.user}update(){const e=new FormData(this.form);this.errors.length&&(this.errors.length=0,this.renderComponent()),this.endpoint.user({bio:e.get("bio").toString(),email:e.get("email").toString(),image:e.get("image").toString(),password:e.get("password").toString(),username:e.get("username").toString()}).subscribe({error:({response:e})=>{for(const r in e.errors)for(const t of e.errors[r])this.errors.push(`${r} ${t}`);this.renderComponent()},next:({username:e})=>{this.router.navigate("/profile/"+e).subscribe()}})}};e([s(()=>l)],f.prototype,"credentials",void 0),e([s(()=>g)],f.prototype,"endpoint",void 0),e([d("form",["input"])],f.prototype,"form",void 0),e([s(()=>c)],f.prototype,"router",void 0),f=e([p({parent:h,path:"settings"}),u("settings-component")],f);export{g as LazyEndpoint,f as SettingsComponent};
//# sourceMappingURL=index.modern.js.map
