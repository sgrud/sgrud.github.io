var _extends=require("@babel/runtime/helpers/extends"),_createClass=require("@babel/runtime/helpers/createClass"),_inheritsLoose=require("@babel/runtime/helpers/inheritsLoose"),_wrapNativeSuper=require("@babel/runtime/helpers/wrapNativeSuper"),tslib=require("tslib"),jsxRuntime=require("@sgrud/shell/jsx-runtime"),core=require("@sgrud/core"),shell=require("@sgrud/shell"),rxjs=require("rxjs"),sgrudRealworldCore=require("sgrud-realworld-core"),sgrudRealworldEager=require("sgrud-realworld-eager");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var _extends__default=/*#__PURE__*/_interopDefaultLegacy(_extends),_createClass__default=/*#__PURE__*/_interopDefaultLegacy(_createClass),_inheritsLoose__default=/*#__PURE__*/_interopDefaultLegacy(_inheritsLoose),_wrapNativeSuper__default=/*#__PURE__*/_interopDefaultLegacy(_wrapNativeSuper);exports.EditorComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.form=void 0,t.article=void 0,t.errors=void 0,t}return _inheritsLoose__default.default(t,e),t.prototype.updateArticle=function(){var e=this,t=new FormData(this.form);this.errors&&(this.errors=void 0,this.renderComponent()),sgrudRealworldCore.Endpoint.updateArticle(_extends__default.default({},this.article,{body:t.get("body").toString(),description:t.get("description").toString(),tagList:t.get("tagList").toString().split(" "),title:t.get("title").toString()})).subscribe({error:function(t){e.errors=t.errors,e.renderComponent()},next:function(t){return e.router.navigate("/article/"+t.slug).subscribe()}})},_createClass__default.default(t,[{key:"template",get:function(){var e,t,r,s,o,i,n,l,a=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"editor-page",children:jsxRuntime.jsx("div",{className:"container page",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-10 col-xs-12 offset-md-1",children:[jsxRuntime.jsx(sgrudRealworldEager.ErrorMessages,{errors:this.errors}),jsxRuntime.jsx("form",{children:jsxRuntime.jsxs("fieldset",{children:[jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"title",placeholder:"Article Title",required:!0,type:"text",value:null!=(e=null==(t=this.article)?void 0:t.title)?e:""})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control",name:"description",placeholder:"What's this article about?",required:!0,type:"text",value:null!=(r=null==(s=this.article)?void 0:s.description)?r:""})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("textarea",{className:"form-control",name:"body",placeholder:"Write your article (in markdown)",required:!0,rows:8,children:null==(o=this.article)?void 0:o.body})}),jsxRuntime.jsxs("fieldset",{className:"form-group",children:[jsxRuntime.jsx("input",{className:"form-control",name:"tagList",placeholder:"Enter tags",type:"text",value:null!=(i=null==(n=this.article)?void 0:n.tagList.join(" "))?i:""}),jsxRuntime.jsx("div",{className:"tag-list"})]}),jsxRuntime.jsx("button",{className:"btn btn-lg btn-primary pull-xs-right",disabled:!(null!=(l=this.form)&&l.checkValidity())||void 0,onclick:function(){return a.updateArticle()},type:"button",children:"Publish Article"})]})},"form")]})})})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.EditorComponent.prototype,"router",void 0),tslib.__decorate([shell.Reference("form",["input"])],exports.EditorComponent.prototype,"form",void 0),tslib.__decorate([shell.Resolve(function(e){var t=e.params;return t.slug?sgrudRealworldCore.Endpoint.readArticle(t.slug):rxjs.of(void 0)})],exports.EditorComponent.prototype,"article",void 0),exports.EditorComponent=tslib.__decorate([shell.Route({parent:sgrudRealworldEager.AppComponent,path:"editor/:slug?"}),shell.Component("editor-component")],exports.EditorComponent),exports.SettingsComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.userStore=void 0,t.userState=void 0,t.form=void 0,t.errors=void 0,t}_inheritsLoose__default.default(t,e);var r=t.prototype;return r.dispatchLogout=function(){var e=this;this.userStore.dispatch("logout").subscribe({error:function(t){e.errors=t.errors,e.renderComponent()},next:function(){return e.router.navigate("/login").subscribe()}})},r.dispatchUpdate=function(){var e=this,t=new FormData(this.form);this.errors&&(this.errors=void 0,this.renderComponent()),this.userStore.dispatch("update",[{bio:t.get("bio").toString(),email:t.get("email").toString(),image:t.get("image").toString(),password:t.get("password").toString(),username:t.get("username").toString()}]).subscribe({error:function(t){e.errors=t.errors,e.renderComponent()},next:function(t){return e.router.navigate("/profile/"+t.username).subscribe()}})},_createClass__default.default(t,[{key:"template",get:function(){var e,t,r,s,o,i,n,l,a=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"settings-page",children:jsxRuntime.jsx("div",{className:"container page",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-6 col-xs-12 offset-md-3",children:[jsxRuntime.jsx("h1",{className:"text-xs-center",children:"Your Settings"}),jsxRuntime.jsx(sgrudRealworldEager.ErrorMessages,{errors:this.errors}),jsxRuntime.jsx("form",{children:jsxRuntime.jsxs("fieldset",{children:[jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control",name:"image",placeholder:"URL of profile picture",type:"url",value:null!=(e=null==(t=this.userState)?void 0:t.image)?e:""})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"username",placeholder:"Your Name",required:!0,type:"text",value:null!=(r=null==(s=this.userState)?void 0:s.username)?r:""})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("textarea",{className:"form-control form-control-lg",name:"bio",placeholder:"Short bio about you",rows:8,children:null==(o=this.userState)?void 0:o.bio})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"email",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",placeholder:"Email",required:!0,type:"email",value:null!=(i=null==(n=this.userState)?void 0:n.email)?i:""})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"password",pattern:"^.{8,}$",placeholder:"Password",type:"password"})}),jsxRuntime.jsx("button",{className:"btn btn-lg btn-primary pull-xs-right",disabled:!(null!=(l=this.form)&&l.checkValidity())||void 0,onclick:function(){return a.dispatchUpdate()},type:"button",children:"Update Settings"})]})},"form"),jsxRuntime.jsx("hr",{}),jsxRuntime.jsx("button",{className:"btn btn-outline-danger",onclick:function(){return a.dispatchLogout()},type:"button",children:"Or click here to logout."})]})})})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.SettingsComponent.prototype,"router",void 0),tslib.__decorate([core.Factor(function(){return sgrudRealworldCore.UserStore})],exports.SettingsComponent.prototype,"userStore",void 0),tslib.__decorate([shell.Fluctuate(function(){return new sgrudRealworldCore.UserStore})],exports.SettingsComponent.prototype,"userState",void 0),tslib.__decorate([shell.Reference("form",["input"])],exports.SettingsComponent.prototype,"form",void 0),exports.SettingsComponent=tslib.__decorate([shell.Route({parent:sgrudRealworldEager.AppComponent,path:"settings"}),shell.Component("settings-component")],exports.SettingsComponent);
//# sourceMappingURL=index.js.map
