{"version":3,"file":"index.modern.js","sources":["../../packages/lazy/src/component/editor.tsx","../../packages/lazy/src/component/settings.tsx"],"sourcesContent":["import { Factor } from '@sgrud/core';\nimport { Component, Reference, Resolve, Route, Router } from '@sgrud/shell';\nimport { of } from 'rxjs';\nimport { Article, Endpoint, Errors } from 'sgrud-realworld-core';\nimport { AppComponent, ErrorMessages } from 'sgrud-realworld-eager';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'editor-component': EditorComponent;\n  }\n}\n\n@Route({\n  parent: AppComponent,\n  path: 'editor/:slug?'\n})\n@Component('editor-component')\nexport class EditorComponent extends HTMLElement implements Component {\n\n  public readonly styles: string[] = ['@import url(\"/realworld/style.css\");'];\n\n  @Factor(() => Router)\n  private readonly router!: Router;\n\n  @Reference('form', ['input'])\n  private readonly form?: HTMLFormElement | undefined;\n\n  @Resolve<'editor/:slug?'>(({ params }) => {\n    return params.slug\n      ? Endpoint.readArticle(params.slug)\n      : of(undefined);\n  })\n  private readonly article?: Article | undefined;\n\n  private errors?: Errors | undefined;\n\n  public get template(): JSX.Element {\n    return <>\n      <div className=\"editor-page\">\n        <div className=\"container page\">\n          <div className=\"row\">\n            <div className=\"col-md-10 col-xs-12 offset-md-1\">\n              <ErrorMessages errors={this.errors}/>\n              <form key=\"form\">\n                <fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"title\"\n                      placeholder=\"Article Title\"\n                      required={true}\n                      type=\"text\"\n                      value={this.article?.title ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"description\"\n                      placeholder=\"What's this article about?\"\n                      required={true}\n                      type=\"text\"\n                      value={this.article?.description ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <textarea\n                      className=\"form-control\"\n                      name=\"body\"\n                      placeholder=\"Write your article (in markdown)\"\n                      required={true}\n                      rows={8}>\n                      {this.article?.body}\n                    </textarea>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"tagList\"\n                      placeholder=\"Enter tags\"\n                      type=\"text\"\n                      value={this.article?.tagList.join(' ') ?? ''}/>\n                    <div className=\"tag-list\"></div>\n                  </fieldset>\n                  <button\n                    className=\"btn btn-lg btn-primary pull-xs-right\"\n                    disabled={!this.form?.checkValidity() || undefined!}\n                    onclick={() => this.updateArticle()}\n                    type=\"button\">\n                    Publish Article\n                  </button>\n                </fieldset>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>;\n  }\n\n  private updateArticle(this: this & Component): void {\n    const formData = new FormData(this.form);\n\n    if (this.errors) {\n      this.errors = undefined;\n      this.renderComponent!();\n    }\n\n    Endpoint.updateArticle({\n      ...this.article,\n      body: formData.get('body')!.toString(),\n      description: formData.get('description')!.toString(),\n      tagList: formData.get('tagList')!.toString().split(' '),\n      title: formData.get('title')!.toString()\n    }).subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: (article) => this.router.navigate(\n        `/article/${article.slug}`\n      ).subscribe()\n    });\n  }\n\n}\n","import { Factor } from '@sgrud/core';\nimport { Component, Fluctuate, Reference, Route, Router } from '@sgrud/shell';\nimport { Store } from '@sgrud/state';\nimport { Errors, UserStore } from 'sgrud-realworld-core';\nimport { AppComponent, ErrorMessages } from 'sgrud-realworld-eager';\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'settings-component': SettingsComponent;\n  }\n}\n\n@Route({\n  parent: AppComponent,\n  path: 'settings'\n})\n@Component('settings-component')\nexport class SettingsComponent extends HTMLElement implements Component {\n\n  public readonly styles: string[] = ['@import url(\"/realworld/style.css\");'];\n\n  @Factor(() => Router)\n  private readonly router!: Router;\n\n  @Factor(() => UserStore)\n  private readonly userStore!: Store<UserStore>;\n\n  @Fluctuate(() => new UserStore())\n  private readonly userState?: Store.State<UserStore> | undefined;\n\n  @Reference('form', ['input'])\n  private readonly form?: HTMLFormElement | undefined;\n\n  private errors?: Errors | undefined;\n\n  public get template(): JSX.Element {\n    return <>\n      <div className=\"settings-page\">\n        <div className=\"container page\">\n          <div className=\"row\">\n            <div className=\"col-md-6 col-xs-12 offset-md-3\">\n              <h1 className=\"text-xs-center\">Your Settings</h1>\n              <ErrorMessages errors={this.errors}/>\n              <form key=\"form\">\n                <fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control\"\n                      name=\"image\"\n                      placeholder=\"URL of profile picture\"\n                      type=\"url\"\n                      value={this.userState?.image ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"username\"\n                      placeholder=\"Your Name\"\n                      required={true}\n                      type=\"text\"\n                      value={this.userState?.username ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <textarea\n                      className=\"form-control form-control-lg\"\n                      name=\"bio\"\n                      placeholder=\"Short bio about you\"\n                      rows={8}>\n                      {this.userState?.bio}\n                    </textarea>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"email\"\n                      pattern=\"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$\"\n                      placeholder=\"Email\"\n                      required={true}\n                      type=\"email\"\n                      value={this.userState?.email ?? ''}/>\n                  </fieldset>\n                  <fieldset className=\"form-group\">\n                    <input\n                      className=\"form-control form-control-lg\"\n                      name=\"password\"\n                      pattern=\"^.{8,}$\"\n                      placeholder=\"Password\"\n                      type=\"password\"/>\n                  </fieldset>\n                  <button\n                    className=\"btn btn-lg btn-primary pull-xs-right\"\n                    disabled={!this.form?.checkValidity() || undefined!}\n                    onclick={() => this.dispatchUpdate()}\n                    type=\"button\">\n                    Update Settings\n                  </button>\n                </fieldset>\n              </form>\n              <hr />\n              <button\n                className=\"btn btn-outline-danger\"\n                onclick={() => this.dispatchLogout()}\n                type=\"button\">\n                Or click here to logout.\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>;\n  }\n\n  private dispatchLogout(this: this & Component): void {\n    this.userStore.dispatch('logout').subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: () => this.router.navigate(\n        '/login'\n      ).subscribe()\n    });\n  }\n\n  private dispatchUpdate(this: this & Component): void {\n    const formData = new FormData(this.form);\n\n    if (this.errors) {\n      this.errors = undefined;\n      this.renderComponent!();\n    }\n\n    this.userStore.dispatch('update', [{\n      bio: formData.get('bio')!.toString(),\n      email: formData.get('email')!.toString(),\n      image: formData.get('image')!.toString(),\n      password: formData.get('password')!.toString(),\n      username: formData.get('username')!.toString()\n    }]).subscribe({\n      error: ({ errors }: { errors: Errors }) => {\n        this.errors = errors;\n        this.renderComponent!();\n      },\n      next: ({ username }) => this.router.navigate(\n        `/profile/${username!}`\n      ).subscribe()\n    });\n  }\n\n}\n"],"names":["EditorComponent","HTMLElement","constructor","args","this","styles","router","form","article","errors","template","_this$article$title","_this$article","_this$article$descrip","_this$article2","_this$article3","_this$article$tagList","_this$article4","_this$form","_jsx","_Fragment","children","className","_jsxs","ErrorMessages","name","placeholder","required","type","value","title","description","rows","body","tagList","join","disabled","checkValidity","undefined","onclick","updateArticle","formData","FormData","renderComponent","Endpoint","_extends","get","toString","split","subscribe","error","next","navigate","slug","__decorate","Factor","Router","prototype","Reference","Resolve","params","readArticle","of","Route","parent","AppComponent","path","Component","SettingsComponent","super","userStore","userState","_this$userState$image","_this$userState","_this$userState$usern","_this$userState2","_this$userState3","_this$userState$email","_this$userState4","image","username","bio","pattern","email","dispatchUpdate","dispatchLogout","dispatch","password","UserStore","Fluctuate"],"mappings":"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"}