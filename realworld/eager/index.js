var _createClass=require("@babel/runtime/helpers/createClass"),_inheritsLoose=require("@babel/runtime/helpers/inheritsLoose"),_wrapNativeSuper=require("@babel/runtime/helpers/wrapNativeSuper"),tslib=require("tslib"),jsxRuntime=require("@sgrud/shell/jsx-runtime"),core=require("@sgrud/core"),shell=require("@sgrud/shell"),state=require("@sgrud/state"),rxjs=require("rxjs"),sgrudRealworldCore=require("sgrud-realworld-core"),marked=require("marked"),_extends=require("@babel/runtime/helpers/extends");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var _temp,_createClass__default=/*#__PURE__*/_interopDefaultLegacy(_createClass),_inheritsLoose__default=/*#__PURE__*/_interopDefaultLegacy(_inheritsLoose),_wrapNativeSuper__default=/*#__PURE__*/_interopDefaultLegacy(_wrapNativeSuper),_extends__default=/*#__PURE__*/_interopDefaultLegacy(_extends);function ArticleComment(e){var t=e.children,r=e.comment,s=r.createdAt,n=e.comment.author,i=n.image,o=n.username,a="/profile/"+o;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"card",children:[jsxRuntime.jsx("div",{className:"card-block",children:jsxRuntime.jsx("p",{className:"card-text",children:r.body})}),jsxRuntime.jsxs("div",{className:"card-footer",children:[jsxRuntime.jsx("a",{className:"comment-author",href:a,is:"router-link",children:jsxRuntime.jsx("img",{className:"comment-author-img",src:i})})," ",jsxRuntime.jsx("a",{className:"comment-author",href:a,is:"router-link",children:o}),jsxRuntime.jsx("span",{className:"date-posted",children:new Date(s).toLocaleString()}),t]})]})})}function ArticleMeta(e){var t=e.children,r=e.article.author,s=r.image,n=r.username,i=new Date(e.article.createdAt).toLocaleString(),o="/profile/"+n;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"article-meta",children:[jsxRuntime.jsx("a",{href:o,is:"router-link",children:jsxRuntime.jsx("img",{src:s})}),jsxRuntime.jsxs("div",{className:"info",children:[jsxRuntime.jsx("a",{className:"author",href:o,is:"router-link",children:n}),jsxRuntime.jsx("span",{className:"date",children:i})]}),t]})})}function ArticleTags(e){var t=e.tagList;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:t.length>0&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("ul",{className:"tag-list",children:t.map(function(e){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("li",{className:"tag-default tag-outline tag-pill",children:e})})})})})})}function DeleteButton(e){var t=e.ondelete.bind(void 0,e.article),r="btn btn-sm btn-outline-danger";return e.className&&(r+=" "+e.className),jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("button",{className:r,onclick:t,type:"button",children:[jsxRuntime.jsx("i",{className:"ion-trash-a"})," Delete Article"]})})}function EditButton(e){var t="btn btn-sm btn-outline-secondary";return e.className&&(t+=" "+e.className),jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("a",{className:t,href:"/editor/"+e.article.slug,is:"router-link",children:[jsxRuntime.jsx("i",{className:"ion-edit"})," Edit Article"]})})}function FollowButton(e){var t=e.profile,r=t.username,s=t.following,n=e.onfollow.bind(void 0,t),i="btn btn-sm btn"+(s?"-":"-outline-")+"secondary";return e.className&&(i+=" "+e.className),jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("button",{className:i,onclick:n,type:"button",children:[jsxRuntime.jsx("i",{className:"ion-plus-round"})," ",s?"Unfollow":"Follow"," ",r]})})}function LikeButton(e){var t=e.article,r=e.children,s=t.favorited,n=e.onlike.bind(void 0,t),i="btn btn-sm btn"+(s?"-":"-outline-")+"primary";return e.className&&(i+=" "+e.className),jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("button",{className:i,onclick:n,type:"button",children:[jsxRuntime.jsx("i",{className:"ion-heart"})," ",r]})})}function ArticlePager(e){var t=e.count,r=e.limit,s=e.onoffset,n=Math.floor(e.offset/r)+1,i=Math.ceil(t/r);return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("nav",{children:jsxRuntime.jsx("ul",{className:"pagination",children:new Array(i).fill(null).map(function(e,t){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("li",{className:"page-item "+(t+1===n?"active":""),children:jsxRuntime.jsx("a",{className:"page-link",href:"#",onclick:function(e){s(t*r),e.preventDefault()},children:t+1})})})})})})})}function ArticlePreview(e){var t=e.article,r=t.description,s=t.slug,n=t.tagList,i=t.title;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"article-preview",children:[jsxRuntime.jsx(ArticleMeta,{article:t,children:jsxRuntime.jsx(LikeButton,{article:t,className:"pull-xs-right",onlike:e.onlike,children:t.favoritesCount})}),jsxRuntime.jsxs("a",{className:"preview-link",href:"/article/"+s,is:"router-link",children:[jsxRuntime.jsx("h1",{children:i}),jsxRuntime.jsx("p",{children:r}),jsxRuntime.jsx("span",{children:"Read more..."}),jsxRuntime.jsx(ArticleTags,{tagList:n})]})]})})}function ArticleList(e){var t=e.articles,r=e.articlesCount,s=e.limit,n=e.offset,i=e.onlike,o=e.onoffset;return r?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[t.map(function(e){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx(ArticlePreview,{article:e,onlike:i})})}),t.length<r&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx(ArticlePager,{count:r,limit:s,offset:n,onoffset:o})})]}):jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"article-preview",children:"No articles are here... yet."})})}function ErrorMessages(e){var t=e.errors;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:t&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("ul",{className:"error-messages",children:Object.keys(t).map(function(e){return t[e].map(function(t){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("li",{children:[e," ",t]})})})})})})})}exports.ArticleComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.userState=void 0,t.form=void 0,t.article=void 0,t.comments=void 0,t}_inheritsLoose__default.default(t,e);var r=t.prototype;return r.removeArticle=function(){var e=this;sgrudRealworldCore.Endpoint.removeArticle(this.article).subscribe(function(){e.router.navigate("/profile/"+e.userState.username).subscribe()})},r.removeComment=function(e){var t=this;sgrudRealworldCore.Endpoint.removeComment(this.article,e).subscribe(function(){t.comments.splice(t.comments.indexOf(e),1),t.renderComponent()})},r.updateComment=function(){var e=this,t=new FormData(this.form);sgrudRealworldCore.Endpoint.updateComment(this.article,{body:t.get("body").toString()}).subscribe(function(t){var r;e.comments.unshift(t),e.renderComponent(),null==(r=e.form)||r.reset()})},r.updateFollow=function(){var e,t=this;null!=(e=this.userState)&&e.token?sgrudRealworldCore.Endpoint.updateFollow(this.article.author).subscribe(function(e){core.assign(t.article.author,e),t.renderComponent()}):this.router.navigate("/login").subscribe()},r.updateLike=function(){var e,t=this;null!=(e=this.userState)&&e.token?sgrudRealworldCore.Endpoint.updateLike(this.article).subscribe(function(e){core.assign(t.article,e),t.renderComponent()}):this.router.navigate("/login").subscribe()},_createClass__default.default(t,[{key:"template",get:function(){var e,t,r,s,n,i,o=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"article-page",children:[jsxRuntime.jsx("div",{className:"banner",children:jsxRuntime.jsxs("div",{className:"container",children:[jsxRuntime.jsx("h1",{children:this.article.title}),jsxRuntime.jsx(ArticleMeta,{article:this.article,children:this.article.author.username===(null==(e=this.userState)?void 0:e.username)?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(EditButton,{article:this.article})," ",jsxRuntime.jsx(DeleteButton,{article:this.article,ondelete:function(){return o.removeArticle()}})]}):jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(FollowButton,{profile:this.article.author,onfollow:function(){return o.updateFollow()}})," ",jsxRuntime.jsxs(LikeButton,{article:this.article,onlike:function(){return o.updateLike()},children:[this.article.favorited&&null!=(t=this.userState)&&t.token?"Unfavorite":"Favorite"," Article"," ",jsxRuntime.jsxs("span",{className:"counter",children:["(",this.article.favoritesCount,")"]})]})]})})]})}),jsxRuntime.jsxs("div",{className:"container page",children:[jsxRuntime.jsx("div",{className:"row article-content",children:jsxRuntime.jsxs("div",{className:"col-md-12",children:[jsxRuntime.jsx("div",{children:shell.html(marked.marked(this.article.body))}),jsxRuntime.jsx(ArticleTags,{tagList:this.article.tagList})]})}),jsxRuntime.jsx("hr",{}),jsxRuntime.jsx("div",{className:"article-actions",children:jsxRuntime.jsx(ArticleMeta,{article:this.article,children:this.article.author.username===(null==(r=this.userState)?void 0:r.username)?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(EditButton,{article:this.article})," ",jsxRuntime.jsx(DeleteButton,{article:this.article,ondelete:function(){return o.removeArticle()}})]}):jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(FollowButton,{profile:this.article.author,onfollow:function(){return o.updateFollow()}})," ",jsxRuntime.jsxs(LikeButton,{article:this.article,onlike:function(){return o.updateLike()},children:[this.article.favorited&&null!=(s=this.userState)&&s.token?"Unfavorite":"Favorite"," Article"," ",jsxRuntime.jsxs("span",{className:"counter",children:["(",this.article.favoritesCount,")"]})]})]})})}),jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-8 col-xs-12 offset-md-2",children:[null!=(n=this.userState)&&n.token?jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("form",{className:"card comment-form",children:[jsxRuntime.jsx("div",{className:"card-block",children:jsxRuntime.jsx("textarea",{className:"form-control",name:"body",placeholder:"Write a comment...",required:!0,rows:3})}),jsxRuntime.jsxs("div",{className:"card-footer",children:[jsxRuntime.jsx("img",{className:"comment-author-img",src:this.userState.image}),jsxRuntime.jsx("button",{className:"btn btn-sm btn-primary",disabled:!(null!=(i=this.form)&&i.checkValidity())||void 0,onclick:function(){return o.updateComment()},type:"button",children:"Post Comment"})]})]},"form")}):jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("a",{href:"/login",is:"router-link",children:"Sign in"})," or"," ",jsxRuntime.jsx("a",{href:"/register",is:"router-link",children:"sign up"})," ","to add comments on this article."]}),this.comments.map(function(e){var t;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx(ArticleComment,{comment:e,children:e.author.username===(null==(t=o.userState)?void 0:t.username)&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("span",{className:"mod-options",children:jsxRuntime.jsx("i",{className:"ion-trash-a",onclick:function(){o.removeComment(e)}})})})})})})]})})]})]})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.ArticleComponent.prototype,"router",void 0),tslib.__decorate([shell.Fluctuate(function(){return new sgrudRealworldCore.UserStore})],exports.ArticleComponent.prototype,"userState",void 0),tslib.__decorate([shell.Reference("form",["input"])],exports.ArticleComponent.prototype,"form",void 0),tslib.__decorate([shell.Resolve(function(e){return sgrudRealworldCore.Endpoint.readArticle(e.params.slug)})],exports.ArticleComponent.prototype,"article",void 0),tslib.__decorate([shell.Resolve(function(e){return sgrudRealworldCore.Endpoint.readComments(e.params.slug)})],exports.ArticleComponent.prototype,"comments",void 0),exports.ArticleComponent=tslib.__decorate([shell.Route({path:"article/:slug"}),shell.Component("article-component")],exports.ArticleComponent),exports.ErrorComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.error=void 0,t}return _inheritsLoose__default.default(t,e),t.prototype.connectedCallback=function(){this.error&&(console.error(this.error),this.renderComponent())},_createClass__default.default(t,[{key:"template",get:function(){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"home-page",children:jsxRuntime.jsx("div",{className:"banner",style:{background:"#b85c5c"},children:jsxRuntime.jsxs("div",{className:"container",children:[jsxRuntime.jsx("h1",{className:"logo-font",children:"error"}),jsxRuntime.jsxs("p",{children:[jsxRuntime.jsx("strong",{children:this.error.name}),": ",this.error.message]})]})})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([shell.Catch()],exports.ErrorComponent.prototype,"error",void 0),exports.ErrorComponent=tslib.__decorate([shell.Route({path:"error"}),shell.Component("error-component")],exports.ErrorComponent),exports.FooterComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t}return _inheritsLoose__default.default(t,e),_createClass__default.default(t,[{key:"template",get:function(){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("footer",{children:jsxRuntime.jsxs("div",{className:"container",children:[jsxRuntime.jsx("a",{className:"logo-font",href:"/",is:"router-link",children:"conduit"}),jsxRuntime.jsxs("span",{className:"attribution",children:["© ",(new Date).getFullYear(),". An interactive learning project from"," ",jsxRuntime.jsx("a",{href:"https://thinkster.io",children:"Thinkster"}),". Code licensed under MIT."]})]})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),exports.FooterComponent=tslib.__decorate([shell.Component("footer-component")],exports.FooterComponent),exports.HeaderComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.routerState=void 0,t.userState=void 0,t}return _inheritsLoose__default.default(t,e),t.prototype.navLink=function(){var e,t={className:"nav-link",href:"/"+[].slice.call(arguments).join("/"),is:"router-link"};return(null==(e=this.routerState)?void 0:e.path)===this.router.rebase(t.href,!1)&&(t.className+=" active"),t},_createClass__default.default(t,[{key:"template",get:function(){var e;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("nav",{className:"navbar navbar-light",children:jsxRuntime.jsxs("div",{className:"container",children:[jsxRuntime.jsx("a",{className:"navbar-brand",href:"/",is:"router-link",children:"conduit"}),jsxRuntime.jsxs("ul",{className:"nav navbar-nav pull-xs-right",children:[jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink(),{children:"Home"}))}),null!=(e=this.userState)&&e.token?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsxs("a",_extends__default.default({},this.navLink("editor"),{children:[jsxRuntime.jsx("i",{className:"ion-compose"})," New Article"]}))}),jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsxs("a",_extends__default.default({},this.navLink("settings"),{children:[jsxRuntime.jsx("i",{className:"ion-gear-a"})," Settings"]}))}),jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsxs("a",_extends__default.default({},this.navLink("profile",this.userState.username),{children:[jsxRuntime.jsx("img",{className:"user-pic",src:this.userState.image}),this.userState.username]}))})]}):jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink("login"),{children:"Sign in"}))}),jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink("register"),{children:"Sign up"}))})]})]})]})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.HeaderComponent.prototype,"router",void 0),tslib.__decorate([shell.Fluctuate(function(){return new shell.Router})],exports.HeaderComponent.prototype,"routerState",void 0),tslib.__decorate([shell.Fluctuate(function(){return new sgrudRealworldCore.UserStore})],exports.HeaderComponent.prototype,"userState",void 0),exports.HeaderComponent=tslib.__decorate([shell.Component("header-component")],exports.HeaderComponent),exports.HomeComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.userState=void 0,t.articles=void 0,t.tagList=void 0,t}_inheritsLoose__default.default(t,e);var r=t.prototype;return r.navLink=function(e){var t=this,r={className:"nav-link",href:"#",onclick:function(r){t.readArticles(_extends__default.default({},e,{offset:0})),r.preventDefault()}};return Object.keys(e).every(function(r){var s;return e[r]===(null==(s=t.articles)?void 0:s[r])})&&(r.className+=" active"),r},r.navPill=function(e){var t=this,r={className:"tag-pill tag-default",href:"#",onclick:function(r){t.readArticles({offset:0,path:void 0,tag:e}),r.preventDefault()}};return e===this.articles.tag&&(r.className+=" active"),r},r.readArticles=function(e){var t=this,r=this.articles;sgrudRealworldCore.Endpoint.readArticles(_extends__default.default({offset:r.offset,path:r.path,tag:r.tag},e)).subscribe(function(e){t.articles=e,t.renderComponent()})},r.updateLike=function(e){var t,r=this;null!=(t=this.userState)&&t.token?sgrudRealworldCore.Endpoint.updateLike(e).subscribe(function(t){var s=r.articles.articles.indexOf(e);r.articles.articles.splice(s,1,t),r.renderComponent()}):this.router.navigate("/login").subscribe()},_createClass__default.default(t,[{key:"template",get:function(){var e,t=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"home-page",children:[jsxRuntime.jsx("div",{className:"banner",children:jsxRuntime.jsxs("div",{className:"container",children:[jsxRuntime.jsx("h1",{className:"logo-font",children:"conduit"}),jsxRuntime.jsxs("p",{children:["A place to share your ",jsxRuntime.jsx("i",{children:"SGRUD"})," knowledge."]})]})}),jsxRuntime.jsx("div",{className:"container page",children:jsxRuntime.jsxs("div",{className:"row",children:[jsxRuntime.jsxs("div",{className:"col-md-9",children:[jsxRuntime.jsx("div",{className:"feed-toggle",children:jsxRuntime.jsxs("ul",{className:"nav nav-pills outline-active",children:[(null==(e=this.userState)?void 0:e.token)&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink({path:"feed",tag:void 0}),{children:"Your Feed"}))})}),jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink({path:void 0,tag:void 0}),{children:"Global Feed"}))}),this.articles.tag&&jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsxs("a",_extends__default.default({},this.navLink({path:void 0,tag:this.articles.tag}),{children:[jsxRuntime.jsx("i",{className:"ion-pound"})," ",this.articles.tag]}))})})]})}),jsxRuntime.jsx(ArticleList,_extends__default.default({},this.articles,{onlike:function(e){return t.updateLike(e)},onoffset:function(e){return t.readArticles({offset:e})}}))]}),jsxRuntime.jsx("div",{className:"col-md-3",children:jsxRuntime.jsxs("div",{className:"sidebar",children:[jsxRuntime.jsx("p",{children:"Popular Tags"}),jsxRuntime.jsx(jsxRuntime.Fragment,this.tagList.length>0?{children:jsxRuntime.jsx("div",{className:"tag-list",children:this.tagList.map(function(e){return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("a",_extends__default.default({},t.navPill(e),{children:e}))})})})}:{children:jsxRuntime.jsx("div",{children:"No tags are here... yet."})})]})})]})})]})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.HomeComponent.prototype,"router",void 0),tslib.__decorate([shell.Fluctuate(function(){return new sgrudRealworldCore.UserStore})],exports.HomeComponent.prototype,"userState",void 0),tslib.__decorate([shell.Resolve(function(){return sgrudRealworldCore.Endpoint.readArticles()})],exports.HomeComponent.prototype,"articles",void 0),tslib.__decorate([shell.Resolve(function(){return sgrudRealworldCore.Endpoint.readTags()})],exports.HomeComponent.prototype,"tagList",void 0),exports.HomeComponent=tslib.__decorate([shell.Route({path:""}),shell.Component("home-component")],exports.HomeComponent),exports.LoginComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.store=void 0,t.form=void 0,t.errors=void 0,t}return _inheritsLoose__default.default(t,e),t.prototype.dispatchLogin=function(){var e=this,t=new FormData(this.form);this.errors&&(this.errors=void 0,this.renderComponent()),this.store.dispatch("login",[t.get("email").toString(),t.get("password").toString()]).subscribe({error:function(t){e.errors=t.errors,e.renderComponent()},next:function(t){return e.router.navigate("/profile/"+t.username).subscribe()}})},_createClass__default.default(t,[{key:"template",get:function(){var e,t=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"auth-page",children:jsxRuntime.jsx("div",{className:"container page",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-6 col-xs-12 offset-md-3",children:[jsxRuntime.jsx("h1",{className:"text-xs-center",children:"Sign in"}),jsxRuntime.jsx("p",{className:"text-xs-center",children:jsxRuntime.jsx("a",{href:"/register",is:"router-link",children:"Need an account?"})}),jsxRuntime.jsx(ErrorMessages,{errors:this.errors}),jsxRuntime.jsxs("form",{children:[jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"email",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",placeholder:"Email",required:!0,type:"email"})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"password",pattern:"^.{8,}$",placeholder:"Password",required:!0,type:"password"})}),jsxRuntime.jsx("button",{className:"btn btn-lg btn-primary pull-xs-right",disabled:!(null!=(e=this.form)&&e.checkValidity())||void 0,onclick:function(){return t.dispatchLogin()},type:"button",children:"Sign in"})]},"form")]})})})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.LoginComponent.prototype,"router",void 0),tslib.__decorate([core.Factor(function(){return sgrudRealworldCore.UserStore})],exports.LoginComponent.prototype,"store",void 0),tslib.__decorate([shell.Reference("form",["input"])],exports.LoginComponent.prototype,"form",void 0),exports.LoginComponent=tslib.__decorate([shell.Route({path:"login"}),shell.Component("login-component")],exports.LoginComponent),exports.ProfileComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.routerState=void 0,t.userState=void 0,t.articles=void 0,t.profile=void 0,t}_inheritsLoose__default.default(t,e);var r=t.prototype;return r.navLink=function(){var e,t={className:"nav-link",href:"/profile/"+[this.profile.username].concat([].slice.call(arguments)).join("/"),is:"router-link"};return(null==(e=this.routerState)?void 0:e.path)===this.router.rebase(t.href,!1)&&(t.className+=" active"),t},r.readArticles=function(e){var t=this,r=this.articles;sgrudRealworldCore.Endpoint.readArticles(_extends__default.default({author:r.author,favorited:r.favorited,offset:r.offset},e)).subscribe(function(e){t.articles=e,t.renderComponent()})},r.updateFollow=function(){var e,t=this;null!=(e=this.userState)&&e.token?sgrudRealworldCore.Endpoint.updateFollow(this.profile).subscribe(function(e){core.assign(t.profile,e),t.renderComponent()}):this.router.navigate("/login").subscribe()},r.updateLike=function(e){var t,r=this;null!=(t=this.userState)&&t.token?sgrudRealworldCore.Endpoint.updateLike(e).subscribe(function(t){var s=r.articles.articles.indexOf(e);r.articles.articles.splice(s,1,t),r.renderComponent()}):this.router.navigate("/login").subscribe()},_createClass__default.default(t,[{key:"template",get:function(){var e,t=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("div",{className:"profile-page",children:[jsxRuntime.jsx("div",{className:"user-info",children:jsxRuntime.jsx("div",{className:"container",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-10 col-xs-12 offset-md-1",children:[jsxRuntime.jsx("img",{className:"user-img",src:this.profile.image}),jsxRuntime.jsx("h4",{children:this.profile.username}),jsxRuntime.jsx("p",{children:this.profile.bio}),this.profile.username===(null==(e=this.userState)?void 0:e.username)?jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsxs("a",{className:"btn btn-sm btn-outline-secondary action-btn",href:"/settings",is:"router-link",children:[jsxRuntime.jsx("i",{className:"ion-gear-a"})," Edit Profile Settings"]})}):jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx(FollowButton,{className:"action-btn",onfollow:function(){return t.updateFollow()},profile:this.profile})})]})})})}),jsxRuntime.jsx("div",{className:"container",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-10 col-xs-12 offset-md-1",children:[jsxRuntime.jsx("div",{className:"articles-toggle",children:jsxRuntime.jsxs("ul",{className:"nav nav-pills outline-active",children:[jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink(),{children:"My Articles"}))}),jsxRuntime.jsx("li",{className:"nav-item",children:jsxRuntime.jsx("a",_extends__default.default({},this.navLink("favorites"),{children:"Favorited Articles"}))})]})}),jsxRuntime.jsx(ArticleList,_extends__default.default({},this.articles,{onlike:function(e){return t.updateLike(e)},onoffset:function(e){return t.readArticles({offset:e})}}))]})})})]})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.ProfileComponent.prototype,"router",void 0),tslib.__decorate([shell.Fluctuate(function(){return new shell.Router})],exports.ProfileComponent.prototype,"routerState",void 0),tslib.__decorate([shell.Fluctuate(function(){return new sgrudRealworldCore.UserStore})],exports.ProfileComponent.prototype,"userState",void 0),tslib.__decorate([shell.Resolve(function(e){var t,r=e.params;return sgrudRealworldCore.Endpoint.readArticles(((t={})[r.favorites?"favorited":"author"]=r.username,t))})],exports.ProfileComponent.prototype,"articles",void 0),tslib.__decorate([shell.Resolve(function(e){var t=e.params;return rxjs.from(new sgrudRealworldCore.UserStore).pipe(rxjs.first(),rxjs.switchMap(function(e){return t.username!==e.username?sgrudRealworldCore.Endpoint.readProfile(t.username):rxjs.of(e)}))})],exports.ProfileComponent.prototype,"profile",void 0),exports.ProfileComponent=tslib.__decorate([shell.Route({path:"profile/:username/:favorites?"}),shell.Component("profile-component")],exports.ProfileComponent),exports.RegisterComponent=/*#__PURE__*/function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(t=e.call.apply(e,[this].concat(s))||this).styles=['@import url("/realworld/style.css");'],t.router=void 0,t.store=void 0,t.form=void 0,t.errors=void 0,t}return _inheritsLoose__default.default(t,e),t.prototype.dispatchRegister=function(){var e=this,t=new FormData(this.form);this.errors&&(this.errors=void 0,this.renderComponent()),this.store.dispatch("register",[t.get("email").toString(),t.get("username").toString(),t.get("password").toString()]).subscribe({error:function(t){e.errors=t.errors,e.renderComponent()},next:function(t){return e.router.navigate("/profile/"+t.username).subscribe()}})},_createClass__default.default(t,[{key:"template",get:function(){var e,t=this;return jsxRuntime.jsx(jsxRuntime.Fragment,{children:jsxRuntime.jsx("div",{className:"auth-page",children:jsxRuntime.jsx("div",{className:"container page",children:jsxRuntime.jsx("div",{className:"row",children:jsxRuntime.jsxs("div",{className:"col-md-6 col-xs-12 offset-md-3",children:[jsxRuntime.jsx("h1",{className:"text-xs-center",children:"Sign up"}),jsxRuntime.jsx("p",{className:"text-xs-center",children:jsxRuntime.jsx("a",{href:"/login",is:"router-link",children:"Have an account?"})}),jsxRuntime.jsx(ErrorMessages,{errors:this.errors}),jsxRuntime.jsxs("form",{children:[jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"username",placeholder:"Your Name",required:!0,type:"text"})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"email",pattern:"^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$",placeholder:"Email",required:!0,type:"text"})}),jsxRuntime.jsx("fieldset",{className:"form-group",children:jsxRuntime.jsx("input",{className:"form-control form-control-lg",name:"password",pattern:"^.{8,}$",placeholder:"Password",required:!0,type:"password"})}),jsxRuntime.jsx("button",{className:"btn btn-lg btn-primary pull-xs-right",disabled:!(null!=(e=this.form)&&e.checkValidity())||void 0,onclick:function(){return t.dispatchRegister()},type:"button",children:"Sign up"})]},"form")]})})})})})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.RegisterComponent.prototype,"router",void 0),tslib.__decorate([core.Factor(function(){return sgrudRealworldCore.UserStore})],exports.RegisterComponent.prototype,"store",void 0),tslib.__decorate([shell.Reference("form",["input"])],exports.RegisterComponent.prototype,"form",void 0),exports.RegisterComponent=tslib.__decorate([shell.Route({path:"register"}),shell.Component("register-component")],exports.RegisterComponent),exports.AppComponent=(_temp=/*#__PURE__*/function(e){function t(){var t;return(t=e.call(this)||this).styles=['@import url("/realworld/style.css");'],t.fadeQueue=void 0,t.router=void 0,t.userStore=void 0,t.main=void 0,rxjs.from(t.userStore).pipe(rxjs.first(function(e){return!!e.username}),rxjs.switchMap(function(){return(new core.Kernel).require("/realworld/lazy")})).subscribe(),rxjs.from(t.userStore).pipe(rxjs.filter(function(){return!document.hasFocus()}),rxjs.skipWhile(function(e){return!e.username}),rxjs.map(function(e){var t=e.username;return t?"/profile/"+t:"/login"}),rxjs.switchMap(function(e){return t.router.navigate(e,void 0,"replace")})).subscribe(),t}return _inheritsLoose__default.default(t,e),t.prototype.connectedCallback=function(){var e=this;rxjs.from(state.StateHandler).subscribe(function(){e.renderComponent(),e.fadeQueue.element=e.main})},_createClass__default.default(t,[{key:"template",get:function(){return jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("slot",{name:"header"}),jsxRuntime.jsx("main",{children:jsxRuntime.jsx("slot",{})},"main"),jsxRuntime.jsx("slot",{name:"footer"})]})}}]),t}(/*#__PURE__*/_wrapNativeSuper__default.default(HTMLElement)),new state.StateHandler("/realworld/."),_temp),tslib.__decorate([core.Factor(function(){return sgrudRealworldCore.FadeQueue})],exports.AppComponent.prototype,"fadeQueue",void 0),tslib.__decorate([core.Factor(function(){return shell.Router})],exports.AppComponent.prototype,"router",void 0),tslib.__decorate([core.Factor(function(){return sgrudRealworldCore.UserStore})],exports.AppComponent.prototype,"userStore",void 0),tslib.__decorate([shell.Reference("main")],exports.AppComponent.prototype,"main",void 0),exports.AppComponent=tslib.__decorate([shell.Route({path:"",children:[exports.ArticleComponent,exports.ErrorComponent,exports.HomeComponent,exports.LoginComponent,exports.ProfileComponent,exports.RegisterComponent],slots:{header:exports.HeaderComponent,footer:exports.FooterComponent}}),shell.Component("app-component")],exports.AppComponent),exports.ArticleComment=ArticleComment,exports.ArticleList=ArticleList,exports.ArticleMeta=ArticleMeta,exports.ArticlePager=ArticlePager,exports.ArticlePreview=ArticlePreview,exports.ArticleTags=ArticleTags,exports.DeleteButton=DeleteButton,exports.EditButton=EditButton,exports.ErrorMessages=ErrorMessages,exports.FollowButton=FollowButton,exports.LikeButton=LikeButton;
//# sourceMappingURL=index.js.map
