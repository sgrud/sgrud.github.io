{"version":3,"file":"index.umd.js","sources":["../../packages/core/src/store/config.ts","../../packages/core/src/conduit/endpoint.ts","../../packages/core/src/store/user.ts","../../packages/core/src/proxy/auth.ts","../../packages/core/src/proxy/fade.ts","../../packages/core/src/queue/fade.ts"],"sourcesContent":["import { Bus } from '@sgrud/bus';\nimport { Stateful, Store } from '@sgrud/state';\n\n@Stateful(ConfigStore.handle, {\n  apiUrl: 'https://api.realworld.io/api'\n})\nexport class ConfigStore extends Store<ConfigStore> {\n\n  public static readonly handle: Bus.Handle = 'io.github.sgrud.state.config';\n\n  public readonly apiUrl!: string;\n\n}\n","import { Http } from '@sgrud/core';\nimport { first, from, map, Observable, switchMap } from 'rxjs';\nimport { ConfigStore } from '../store/config';\nimport { Article, Articles, Comment, Profile } from './typing';\n\nexport abstract class Endpoint {\n\n  private static get apiUrl(): Observable<string> {\n    return from(new ConfigStore()).pipe(first(), map(({ apiUrl }) => apiUrl));\n  }\n\n  /*\n   * Read Operations\n   */\n\n  public static readArticles({\n    author = undefined,\n    favorited = undefined,\n    limit = 10,\n    offset = 0,\n    path = undefined,\n    tag = undefined\n  }: Partial<Articles> = {}): Observable<Articles> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<Articles>({\n        queryParams: {\n          ...author && { author },\n          ...favorited && { favorited },\n          ...limit && { limit },\n          ...offset && { offset },\n          ...tag && { tag }\n        },\n        url: `${url}/articles` + (path ? `/${path}` : '')\n      })),\n      map(({ response }) => ({\n        ...response, author, favorited, limit, offset, path, tag\n      }))\n    );\n  }\n\n  public static readArticle(slug: string): Observable<Article> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${slug}`),\n      switchMap((url) => Http.get<{ article: Article }>(url)),\n      map(({ response }) => response.article)\n    );\n  }\n\n  public static readComments(slug: string): Observable<Comment[]> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${slug}/comments`),\n      switchMap((url) => Http.get<{ comments: Comment[] }>(url)),\n      map(({ response }) => response.comments)\n    );\n  }\n\n  public static readProfile(username: string): Observable<Profile> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/profiles/${username}`),\n      switchMap((url) => Http.get<{ profile: Profile }>(url)),\n      map(({ response }) => response.profile)\n    );\n  }\n\n  public static readTags(): Observable<string[]> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/tags`),\n      switchMap((url) => Http.get<{ tags: string[] }>(url)),\n      map(({ response }) => response.tags)\n    );\n  }\n\n  /*\n   * Remove Operations\n   */\n\n  public static removeArticle(\n    article: Article\n  ): Observable<unknown> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${article.slug}`),\n      switchMap((url) => Http.delete<unknown>(url)),\n      map(({ response }) => response)\n    );\n  }\n\n  public static removeComment(\n    article: Article,\n    comment: Comment\n  ): Observable<unknown> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${article.slug}/comments/${comment.id}`),\n      switchMap((url) => Http.delete<unknown>(url)),\n      map(({ response }) => response)\n    );\n  }\n\n  /*\n   * Update Operations\n   */\n\n  public static updateArticle(\n    article: Partial<Article>\n  ): Observable<Article> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ article: Article }>({\n        body: { article },\n        method: article.slug ? 'PUT' : 'POST',\n        url: `${url}/articles` + (article.slug ? `/${article.slug}` : '')\n      })),\n      map(({ response }) => response.article)\n    );\n  }\n\n  public static updateComment(\n    article: Article,\n    comment: Partial<Comment>\n  ): Observable<Comment> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ comment: Comment }>({\n        body: { comment },\n        method: 'POST',\n        url: `${url}/articles/${article.slug}/comments`\n      })),\n      map(({ response }) => response.comment)\n    );\n  }\n\n  public static updateFollow(\n    profile: Profile\n  ): Observable<Profile> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ profile: Profile }>({\n        method: profile.following ? 'DELETE' : 'POST',\n        url: `${url}/profiles/${profile.username}/follow`\n      })),\n      map(({ response }) => response.profile)\n    );\n  }\n\n  public static updateLike(\n    article: Article\n  ): Observable<Article> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ article: Article }>({\n        method: article.favorited ? 'DELETE' : 'POST',\n        url: `${url}/articles/${article.slug}/favorite`\n      })),\n      map(({ response }) => response.article)\n    );\n  }\n\n  /*\n   * Instance Invalidation\n   */\n\n  private constructor() {\n    throw new TypeError('Endpoint.constructor');\n  }\n\n}\n","import { Bus } from '@sgrud/bus';\nimport { Stateful, Store } from '@sgrud/state';\nimport { User } from '../conduit/typing';\nimport { ConfigStore } from './config';\n\n@Stateful(UserStore.handle, {\n  bio: undefined,\n  email: undefined,\n  image: undefined,\n  token: undefined,\n  username: undefined\n})\nexport class UserStore extends Store<UserStore> {\n\n  public static readonly handle: Bus.Handle = 'io.github.sgrud.state.user';\n\n  public readonly bio?: string | undefined;\n\n  public readonly email?: string | undefined;\n\n  public readonly image?: string | undefined;\n\n  public readonly token?: string | undefined;\n\n  public readonly username?: string | undefined;\n\n  public async login(\n    email: string,\n    password: string\n  ): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/users/login`, {\n      method: 'POST',\n      headers: {\n        'accept': 'application/json',\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: {\n          email,\n          password\n        }\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n  public async logout(): Promise<Store.State<this>> {\n    const next = {\n      bio: undefined,\n      email: undefined,\n      image: undefined,\n      password: undefined,\n      token: undefined,\n      username: undefined\n    };\n\n    return Object.assign({}, this, next);\n  }\n\n  public async register(\n    email: string,\n    username: string,\n    password: string\n  ): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/users`, {\n      method: 'POST',\n      headers: {\n        'accept': 'application/json',\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: {\n          email,\n          username,\n          password\n        }\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n  public async update(user: Partial<User>): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/user`, {\n      method: 'PUT',\n      headers: {\n        'accept': 'application/json',\n        'authorization': `Token ${this.token!}`,\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n}\n","import { assign, Factor, Http, Provider, Proxy, Target } from '@sgrud/core';\nimport { StateHandler, Store } from '@sgrud/state';\nimport { first, forkJoin, from, Observable, race, switchMap, timer } from 'rxjs';\nimport { ConfigStore } from '../store/config';\nimport { UserStore } from '../store/user';\n\n@Target()\nexport class UserProxy\n  extends Provider<typeof Proxy>('sgrud.core.Proxy') {\n\n  @Factor(() => ConfigStore)\n  private readonly configStore!: Store<ConfigStore>;\n\n  @Factor(() => UserStore)\n  private readonly userStore!: Store<UserStore>;\n\n  public override handle<T>(\n    request: Http.Request,\n    handler: Http.Handler\n  ): Observable<Http.Response<T>> {\n    return race(StateHandler, timer(0)).pipe(switchMap((stateHandler) => {\n      if (stateHandler instanceof StateHandler) {\n        return forkJoin({\n          configState: from(this.configStore).pipe(first()),\n          userState: from(this.userStore).pipe(first())\n        }).pipe(switchMap(({ configState, userState }) => {\n          if (request.url.startsWith(configState.apiUrl) && userState.token) {\n            assign(request, {\n              headers: {\n                authorization: `Token ${userState.token}`\n              }\n            });\n          }\n\n          return handler.handle(request);\n        }));\n      }\n\n      return handler.handle(request);\n    }));\n  }\n\n}\n","import { Target, Transit } from '@sgrud/core';\nimport { from } from 'rxjs';\n\n@Target([], Transit)\nexport class FadeProxy extends Transit {\n\n  public constructor() {\n    super();\n\n    document.documentElement.style.transition = '250ms filter';\n\n    from(this).subscribe(({ length }) => {\n      document.documentElement.style.filter = `grayscale(${length ? 1 : 0})`;\n      document.documentElement.style.pointerEvents = length ? 'none' : 'auto';\n    });\n  }\n\n}\n","import { Provider, Target } from '@sgrud/core';\nimport { Queue, Router } from '@sgrud/shell';\nimport { Observable, delay, finalize, switchMap, timer } from 'rxjs';\n\n@Target()\nexport class FadeQueue\n  extends Provider<typeof Queue>('sgrud.shell.Queue') {\n\n  public element?: HTMLElement | undefined;\n\n  public override handle(\n    _prev: Router.State,\n    next: Router.State,\n    queue: Router.Queue\n  ): Observable<Router.State> {\n    const { element = document.documentElement } = this;\n\n    element.style.transition ||= 'opacity 100ms';\n    element.style.opacity = '0';\n\n    return timer(100).pipe(\n      switchMap(() => queue.handle(next).pipe(delay(100))),\n      finalize(() => element.style.opacity = '1')\n    );\n  }\n\n}\n"],"names":["ConfigStore","_class","_Store","_this","_len","arguments","length","args","Array","_key","call","apply","concat","apiUrl","_inheritsLoose","Store","handle","ConfigStore_1","__decorate","Stateful","Endpoint","TypeError","readArticles","_temp","_ref","_ref$author","author","undefined","_ref$favorited","favorited","_ref$limit","limit","_ref$offset","offset","_ref$path","path","_ref$tag","tag","this","pipe","switchMap","url","Http","request","queryParams","_extends","map","_ref2","response","readArticle","slug","get","_ref3","article","readComments","_ref4","comments","readProfile","username","_ref5","profile","readTags","_ref6","tags","removeArticle","_ref7","removeComment","comment","id","_ref8","updateArticle","body","method","_ref9","updateComment","_ref10","updateFollow","following","_ref11","updateLike","_ref12","_createClass","key","from","first","_ref13","UserStore","bio","email","image","token","_proto","prototype","login","password","_this2","_sgrud$state$effects","sgrud","state","effects","fetch","Promise","resolve","then","config","headers","accept","JSON","stringify","user","_temp2","_result","_exit","json","Object","assign","ok","_response$json","e","reject","logout","register","_this4","_sgrud$state$effects2","_temp4","_result2","_temp3","_response$json2","update","_this5","_sgrud$state$effects3","authorization","_temp6","_result3","_temp5","_response$json3","UserStore_1","UserProxy","_Provider","configStore","userStore","handler","race","StateHandler","timer","stateHandler","forkJoin","configState","userState","startsWith","Provider","Factor","Target","exports","FadeProxy","_Transit","document","documentElement","style","transition","_assertThisInitialized","subscribe","filter","pointerEvents","Transit","FadeQueue","element","_prev","next","queue","_element$style","_this$element","opacity","delay","finalize"],"mappings":"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"}