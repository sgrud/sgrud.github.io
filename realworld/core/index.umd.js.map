{"version":3,"file":"index.umd.js","sources":["../../packages/core/src/store/config.ts","../../packages/core/src/conduit/endpoint.ts","../../packages/core/src/store/user.ts","../../packages/core/src/proxy/auth.ts","../../packages/core/src/proxy/fade.ts","../../packages/core/src/queue/fade.ts"],"sourcesContent":["import { Bus } from '@sgrud/bus';\nimport { Stateful, Store } from '@sgrud/state';\n\n@Stateful(ConfigStore.handle, {\n  apiUrl: 'https://api.realworld.io/api'\n})\nexport class ConfigStore extends Store<ConfigStore> {\n\n  public static readonly handle: Bus.Handle = 'io.github.sgrud.state.config';\n\n  public readonly apiUrl!: string;\n\n}\n","import { Http } from '@sgrud/core';\nimport { first, from, map, Observable, switchMap } from 'rxjs';\nimport { ConfigStore } from '../store/config';\nimport { Article, Articles, Comment, Profile } from './typing';\n\nexport abstract class Endpoint {\n\n  private static get apiUrl(): Observable<string> {\n    return from(new ConfigStore()).pipe(first(), map(({ apiUrl }) => apiUrl));\n  }\n\n  /*\n   * Read Operations\n   */\n\n  public static readArticles({\n    author = undefined,\n    favorited = undefined,\n    limit = 10,\n    offset = 0,\n    path = undefined,\n    tag = undefined\n  }: Partial<Articles> = {}): Observable<Articles> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<Articles>({\n        queryParams: {\n          ...author && { author },\n          ...favorited && { favorited },\n          ...limit && { limit },\n          ...offset && { offset },\n          ...tag && { tag }\n        },\n        url: `${url}/articles` + (path ? `/${path}` : '')\n      })),\n      map(({ response }) => ({\n        ...response, author, favorited, limit, offset, path, tag\n      }))\n    );\n  }\n\n  public static readArticle(slug: string): Observable<Article> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${slug}`),\n      switchMap((url) => Http.get<{ article: Article }>(url)),\n      map(({ response }) => response.article)\n    );\n  }\n\n  public static readComments(slug: string): Observable<Comment[]> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${slug}/comments`),\n      switchMap((url) => Http.get<{ comments: Comment[] }>(url)),\n      map(({ response }) => response.comments)\n    );\n  }\n\n  public static readProfile(username: string): Observable<Profile> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/profiles/${username}`),\n      switchMap((url) => Http.get<{ profile: Profile }>(url)),\n      map(({ response }) => response.profile)\n    );\n  }\n\n  public static readTags(): Observable<string[]> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/tags`),\n      switchMap((url) => Http.get<{ tags: string[] }>(url)),\n      map(({ response }) => response.tags)\n    );\n  }\n\n  /*\n   * Remove Operations\n   */\n\n  public static removeArticle(\n    article: Article\n  ): Observable<unknown> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${article.slug}`),\n      switchMap((url) => Http.delete<unknown>(url)),\n      map(({ response }) => response)\n    );\n  }\n\n  public static removeComment(\n    article: Article,\n    comment: Comment\n  ): Observable<unknown> {\n    return this.apiUrl.pipe(\n      map((url) => `${url}/articles/${article.slug}/comments/${comment.id}`),\n      switchMap((url) => Http.delete<unknown>(url)),\n      map(({ response }) => response)\n    );\n  }\n\n  /*\n   * Update Operations\n   */\n\n  public static updateArticle(\n    article: Partial<Article>\n  ): Observable<Article> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ article: Article }>({\n        body: { article },\n        method: article.slug ? 'PUT' : 'POST',\n        url: `${url}/articles` + (article.slug ? `/${article.slug}` : '')\n      })),\n      map(({ response }) => response.article)\n    );\n  }\n\n  public static updateComment(\n    article: Article,\n    comment: Partial<Comment>\n  ): Observable<Comment> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ comment: Comment }>({\n        body: { comment },\n        method: 'POST',\n        url: `${url}/articles/${article.slug}/comments`\n      })),\n      map(({ response }) => response.comment)\n    );\n  }\n\n  public static updateFollow(\n    profile: Profile\n  ): Observable<Profile> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ profile: Profile }>({\n        method: profile.following ? 'DELETE' : 'POST',\n        url: `${url}/profiles/${profile.username}/follow`\n      })),\n      map(({ response }) => response.profile)\n    );\n  }\n\n  public static updateLike(\n    article: Article\n  ): Observable<Article> {\n    return this.apiUrl.pipe(\n      switchMap((url) => Http.request<{ article: Article }>({\n        method: article.favorited ? 'DELETE' : 'POST',\n        url: `${url}/articles/${article.slug}/favorite`\n      })),\n      map(({ response }) => response.article)\n    );\n  }\n\n  /*\n   * Instance Invalidation\n   */\n\n  private constructor() {\n    throw new TypeError('Endpoint.constructor');\n  }\n\n}\n","import { Bus } from '@sgrud/bus';\nimport { Stateful, Store } from '@sgrud/state';\nimport { User } from '../conduit/typing';\nimport { ConfigStore } from './config';\n\n@Stateful(UserStore.handle, {\n  bio: undefined,\n  email: undefined,\n  image: undefined,\n  token: undefined,\n  username: undefined\n})\nexport class UserStore extends Store<UserStore> {\n\n  public static readonly handle: Bus.Handle = 'io.github.sgrud.state.user';\n\n  public readonly bio?: string | undefined;\n\n  public readonly email?: string | undefined;\n\n  public readonly image?: string | undefined;\n\n  public readonly token?: string | undefined;\n\n  public readonly username?: string | undefined;\n\n  public async login(\n    email: string,\n    password: string\n  ): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/users/login`, {\n      method: 'POST',\n      headers: {\n        'accept': 'application/json',\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: {\n          email,\n          password\n        }\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n  public async logout(): Promise<Store.State<this>> {\n    const next = {\n      bio: undefined,\n      email: undefined,\n      image: undefined,\n      password: undefined,\n      token: undefined,\n      username: undefined\n    };\n\n    return Object.assign({}, this, next);\n  }\n\n  public async register(\n    email: string,\n    username: string,\n    password: string\n  ): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/users`, {\n      method: 'POST',\n      headers: {\n        'accept': 'application/json',\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user: {\n          email,\n          username,\n          password\n        }\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n  public async update(user: Partial<User>): Promise<Store.State<this>> {\n    const { fetch, state } = sgrud.state.effects;\n    const config = (await state<ConfigStore>('io.github.sgrud.state.config'))!;\n\n    const response = await fetch(`${config.apiUrl}/user`, {\n      method: 'PUT',\n      headers: {\n        'accept': 'application/json',\n        'authorization': `Token ${this.token!}`,\n        'content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        user\n      })\n    });\n\n    if (!response.ok) {\n      throw await response.json();\n    }\n\n    const { user: next } = await response.json();\n    return Object.assign({}, this, next);\n  }\n\n}\n","import { assign, Factor, Http, Provider, Proxy, Target } from '@sgrud/core';\nimport { StateHandler, Store } from '@sgrud/state';\nimport { first, forkJoin, from, Observable, race, switchMap, timer } from 'rxjs';\nimport { ConfigStore } from '../store/config';\nimport { UserStore } from '../store/user';\n\n@Target()\nexport class UserProxy\n  extends Provider<typeof Proxy>('sgrud.core.Proxy') {\n\n  @Factor(() => ConfigStore)\n  private readonly configStore!: Store<ConfigStore>;\n\n  @Factor(() => UserStore)\n  private readonly userStore!: Store<UserStore>;\n\n  public override handle<T>(\n    request: Http.Request,\n    handler: Http.Handler\n  ): Observable<Http.Response<T>> {\n    return race(StateHandler, timer(0)).pipe(switchMap((stateHandler) => {\n      if (stateHandler instanceof StateHandler) {\n        return forkJoin({\n          configState: from(this.configStore).pipe(first()),\n          userState: from(this.userStore).pipe(first())\n        }).pipe(switchMap(({ configState, userState }) => {\n          if (request.url.startsWith(configState.apiUrl) && userState.token) {\n            assign(request, {\n              headers: {\n                authorization: `Token ${userState.token}`\n              }\n            });\n          }\n\n          return handler.handle(request);\n        }));\n      }\n\n      return handler.handle(request);\n    }));\n  }\n\n}\n","import { Target, Transit } from '@sgrud/core';\nimport { from } from 'rxjs';\n\n@Target([], Transit)\nexport class FadeProxy extends Transit {\n\n  public constructor() {\n    super();\n\n    document.documentElement.style.transition = '250ms filter';\n\n    from(this).subscribe(({ length }) => {\n      document.documentElement.style.filter = `grayscale(${length ? 1 : 0})`;\n      document.documentElement.style.pointerEvents = length ? 'none' : 'auto';\n    });\n  }\n\n}\n","import { Provider, Target } from '@sgrud/core';\nimport { Queue, Router } from '@sgrud/shell';\nimport { Observable, delay, finalize, switchMap, timer } from 'rxjs';\n\n@Target()\nexport class FadeQueue\n  extends Provider<typeof Queue>('sgrud.shell.Queue') {\n\n  public element?: HTMLElement | undefined;\n\n  public handle(\n    _prev: Router.State,\n    next: Router.State,\n    queue: Router.Queue\n  ): Observable<Router.State> {\n    if (this.element) {\n      this.element.style.transition ||= 'opacity 100ms';\n      this.element.style.opacity = '0';\n\n      return timer(100).pipe(\n        switchMap(() => queue.handle(next).pipe(delay(50))),\n        finalize(() => this.element!.style.opacity = '1')\n      );\n    }\n\n    return queue.handle(next);\n  }\n\n}\n"],"names":["ConfigStore","_class","_Store","_len","_this","arguments","length","args","Array","_key","call","apply","this","concat","apiUrl","_inheritsLoose","Store","handle","ConfigStore_1","__decorate","Stateful","Endpoint","TypeError","readArticles","_temp","_ref","_ref$author","author","undefined","_ref$favorited","favorited","_ref$limit","limit","_ref$offset","offset","_ref$path","path","_ref$tag","tag","pipe","switchMap","url","Http","request","queryParams","_extends","map","_ref2","response","readArticle","slug","get","_ref3","article","readComments","_ref4","comments","readProfile","username","_ref5","profile","readTags","_ref6","tags","removeArticle","_ref7","removeComment","comment","id","_ref8","updateArticle","body","method","_ref9","updateComment","_ref10","updateFollow","following","_ref11","updateLike","_ref12","_createClass","key","from","first","_ref13","UserStore","bio","email","image","token","_proto","prototype","login","password","_this2","_sgrud$state$effects","sgrud","state","effects","fetch","Promise","resolve","then","config","headers","accept","JSON","stringify","user","_temp2","_result","json","Object","assign","ok","_response$json","e","reject","logout","register","_this4","_sgrud$state$effects2","_temp4","_result2","_exit2","_temp3","_response$json2","update","_this5","_sgrud$state$effects3","authorization","_temp6","_result3","_exit3","_temp5","_response$json3","UserStore_1","UserProxy","_Provider","configStore","userStore","handler","race","StateHandler","timer","stateHandler","forkJoin","configState","userState","startsWith","Provider","Factor","Target","exports","FadeProxy","_Transit","document","documentElement","style","transition","_assertThisInitialized","subscribe","filter","pointerEvents","Transit","FadeQueue","element","_prev","next","queue","_this$element$style","opacity","delay","finalize"],"mappings":"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"}